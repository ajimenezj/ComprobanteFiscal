ComprobanteFiscal
=================

Comprobante fiscal para GP 

Proyecto de CF


Primera carga de los procedimientos 
// PROCEDIMIENTO DE INSERCION DE DATOS TABLA LONC00101
CREATE PROCEDURE LONC00101SI -- LODYNDEV.DBO.LONC00101SI 'TWO','ADAMPARK0001   ','USA-INMI-T2    ','Adam Park Resort                                                 ','','1','logicone','1' 
 @INTERID    NVARCHAR(50)
,@CUSTNMBR    NVARCHAR(50) 
,@CUSTCLAS 	 NVARCHAR(50)
,@CUSTNAME 	 NVARCHAR(50)
,@TIPONCF 	 NVARCHAR(50)
,@NCFSTATUS	 NVARCHAR(1)
,@USERID		 NVARCHAR(50)
,@ACCION     NVARCHAR(1)
AS BEGIN
DECLARE @QUERY NVARCHAR(4000)

IF @ACCION = 1
BEGIN 
SET @QUERY = N'
UPDATE '+@INTERID+'.DBO.LONC00101
 SET CUSTCLAS    = '''+@CUSTCLAS   +''' 
,CUSTNAME 	 = '''+@CUSTNAME 	+'''
,TIPONCF 	 = '''+@TIPONCF 	+'''
,NCFSTATUS	 = '''+@NCFSTATUS	+'''
,MODIFDTE	 = ''' +CONVERT(nvarchar(8), GETDATE(), 112)+ '''
,USERID		 = '''+@USERID		+'''
WHERE CUSTNMBR = '''+@CUSTNMBR+'''
'EXEC SP_EXECUTESQL @QUERY
END

IF @ACCION = 0 
BEGIN
SET @QUERY = N'
INSERT INTO '+@INTERID+'.DBO.LONC00101
(
 CUSTNMBR 
,CUSTCLAS 
,CUSTNAME 
,TIPONCF 
,NCFSTATUS
,CREATDDT
,MODIFDTE
,USERID	
)
VALUES
(
 '''+ @CUSTNMBR  	+'''
,'''+ @CUSTCLAS 	+'''
,'''+ @CUSTNAME 	+'''
,'''+ @TIPONCF 		+'''
,'''+ @NCFSTATUS	+'''
,''' +CONVERT(nvarchar(8), GETDATE(), 112)+ '''
,''' +CONVERT(nvarchar(8), GETDATE(), 112)+ '''
,''' +@USERID	+'''
)
'EXEC SP_EXECUTESQL @QUERY
END
END


// PROCEDIMIENTO DE CONSULTA DE REGISTRO TABLA LONC00101
CREATE PROCEDURE LONC00101S3 -- LONC00101S3 'TWO','ADAMPARK0001   '
 @INTERID NVARCHAR(50)
,@CUSTNMBR NVARCHAR(50)
AS BEGIN
DECLARE @QUERY NVARCHAR(4000)
SET @QUERY = N'
SELECT COUNT(*) AS RESULTADO FROM '+@INTERID+'.DBO.LONC00101
WHERE CUSTNMBR = '''+@CUSTNMBR+'''

'EXEC SP_EXECUTESQL @QUERY

END

